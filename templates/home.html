{% extends 'base.html' %}

{% block title %}首页 - Killua 在线卡密验证系统{% endblock %}

{% block content %}
<!-- 现代化英雄区域 -->
<div class="hero-section animate-on-scroll">
    <div class="container">
        <div class="row align-items-center min-vh-50">
            <div class="col-lg-6 order-2 order-lg-1">
                <div class="hero-content">
                    <div class="hero-badge mb-4">
                        <span class="badge bg-primary hero-badge-animate">
                            <i class="fas fa-rocket me-2"></i>
                            现代化卡密验证解决方案
                        </span>
                    </div>
                    <h1 class="hero-title">
                        <span class="gradient-text hero-title-animate">{{ settings.site_name|default:"Killua" }}</span><br>
                        <span class="hero-subtitle-animate">{{ settings.site_subtitle|default:"在线卡密验证系统" }}</span>
                    </h1>
                    <p class="hero-subtitle hero-description-animate">
                        {{ settings.site_description|default:"为您的软件产品提供安全、可靠、现代化的在线卡密验证服务。支持多种卡密类型，设备绑定，实时统计分析。" }}
                    </p>

                    <!-- 特性亮点 -->
                    <div class="hero-features mb-4">
                        <div class="feature-item">
                            <i class="fas fa-shield-alt"></i>
                            <span>安全可靠</span>
                        </div>
                        <div class="feature-item">
                            <i class="fas fa-bolt"></i>
                            <span>高性能</span>
                        </div>
                        <div class="feature-item">
                            <i class="fas fa-mobile-alt"></i>
                            <span>多设备支持</span>
                        </div>
                        <div class="feature-item">
                            <i class="fas fa-chart-line"></i>
                            <span>实时统计</span>
                        </div>
                    </div>

                    {% if not user.is_authenticated %}
                        <div class="hero-actions d-flex flex-wrap gap-3">
                            {% if settings.enable_registration %}
                                <a href="{% url 'accounts:register' %}" class="btn btn-primary btn-lg hero-btn-animate">
                                    <i class="fas fa-user-plus me-2"></i>立即注册
                                </a>
                            {% endif %}
                            <a href="{% url 'accounts:login' %}" class="btn btn-outline-primary btn-lg hero-btn-animate">
                                <i class="fas fa-sign-in-alt me-2"></i>管理员登录
                            </a>
                        </div>
                    {% else %}
                        <div class="hero-actions">
                            <a href="{% url 'dashboard:index' %}" class="btn btn-primary btn-lg hero-btn-animate">
                                <i class="fas fa-tachometer-alt me-2"></i>进入控制面板
                            </a>
                        </div>
                    {% endif %}
                </div>
            </div>
            <div class="col-lg-6 order-1 order-lg-2">
                <div class="hero-visual text-center">
                    {% if settings.hero_image %}
                        <div class="hero-image-container hero-image-animate">
                            <img src="{{ settings.hero_image.url }}" alt="英雄区域图片" class="hero-custom-image">
                            <div class="image-overlay"></div>
                        </div>
                    {% else %}
                        <div class="hero-icon-container hero-icon-animate">
                            <div class="hero-icon">
                                <i class="fas fa-shield-alt"></i>
                            </div>
                            <div class="hero-particles">
                                <div class="particle"></div>
                                <div class="particle"></div>
                                <div class="particle"></div>
                                <div class="particle"></div>
                                <div class="particle"></div>
                            </div>
                            <div class="hero-glow"></div>
                        </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</div>

<!-- 功能特点 -->
<div class="row mb-5 animate-on-scroll">
    <div class="col-12 text-center mb-5">
        <h2 class="gradient-text mb-3">系统特点</h2>
        <p class="text-muted">专为软件开发者设计的现代化卡密验证解决方案</p>
    </div>
    <div class="col-md-4 mb-4">
        <div class="card card-glass h-100 text-center animate-on-scroll">
            <div class="card-body p-4">
                <div class="feature-icon mb-4">
                    <i class="fas fa-lock fa-3x text-primary"></i>
                </div>
                <h5 class="card-title mb-3">安全可靠</h5>
                <p class="card-text">采用SHA1加密存储卡密，设备绑定机制，有效防止盗用和破解，保障您的软件安全</p>
            </div>
        </div>
    </div>
    <div class="col-md-4 mb-4">
        <div class="card card-glass h-100 text-center animate-on-scroll">
            <div class="card-body p-4">
                <div class="feature-icon mb-4">
                    <i class="fas fa-cogs fa-3x text-success"></i>
                </div>
                <h5 class="card-title mb-3">功能完善</h5>
                <p class="card-text">支持时间卡、次数卡，批量生成，设备管理，数据统计，满足各类软件授权需求</p>
            </div>
        </div>
    </div>
    <div class="col-md-4 mb-4">
        <div class="card card-glass h-100 text-center animate-on-scroll">
            <div class="card-body p-4">
                <div class="feature-icon mb-4">
                    <i class="fas fa-chart-line fa-3x text-info"></i>
                </div>
                <h5 class="card-title mb-3">数据可视化</h5>
                <p class="card-text">实时统计图表，使用趋势分析，API调用监控，让您的业务数据一目了然</p>
            </div>
        </div>
    </div>
</div>

<!-- API 完整文档 -->
<div class="row animate-on-scroll" id="api-docs">
    <div class="col-12">
        <div class="card card-glass">
            <div class="card-header">
                <h3 class="mb-0">
                    <i class="fas fa-book me-2"></i>API 完整文档
                </h3>
            </div>
            <div class="card-body">
                <!-- 基础信息 -->
                <div class="row mb-5">
                    <div class="col-12">
                        <h4 class="text-primary mb-3">
                            <i class="fas fa-info-circle me-2"></i>基础信息
                        </h4>
                        <div class="row">
                            <div class="col-md-6">
                                <h6 class="text-secondary">API基础URL</h6>
                                <code class="d-block p-2 bg-dark text-light rounded mb-3">{{ request.scheme }}://{{ request.get_host }}/api/v1/</code>

                                <h6 class="text-secondary">认证方式</h6>
                                <p class="mb-3">在请求体中包含 <code>api_key</code> 参数进行身份验证</p>
                            </div>
                            <div class="col-md-6">
                                <h6 class="text-secondary">请求格式</h6>
                                <ul class="list-unstyled">
                                    <li><i class="fas fa-check text-success me-2"></i>Content-Type: application/json</li>
                                    <li><i class="fas fa-check text-success me-2"></i>Method: POST</li>
                                    <li><i class="fas fa-check text-success me-2"></i>Body: JSON格式</li>
                                </ul>

                                <h6 class="text-secondary">响应格式</h6>
                                <p class="mb-0">统一的JSON格式，包含 <code>code</code>、<code>success</code>、<code>message</code> 字段</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 错误码说明 -->
                <div class="row mb-5">
                    <div class="col-12">
                        <h4 class="text-warning mb-3">
                            <i class="fas fa-exclamation-triangle me-2"></i>错误码说明
                        </h4>
                        <div class="table-responsive">
                            <table class="table table-hover">
                                <thead class="table-dark">
                                    <tr>
                                        <th>错误码</th>
                                        <th>说明</th>
                                        <th>HTTP状态码</th>
                                        <th>处理建议</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr class="table-success">
                                        <td><span class="badge bg-success">0</span></td>
                                        <td>成功</td>
                                        <td>200</td>
                                        <td>请求成功，可以正常处理返回的数据</td>
                                    </tr>
                                    <tr class="table-warning">
                                        <td><span class="badge bg-warning">1</span></td>
                                        <td>卡密相关错误</td>
                                        <td>400</td>
                                        <td>检查卡密是否存在、有效或设备绑定</td>
                                    </tr>
                                    <tr class="table-danger">
                                        <td><span class="badge bg-danger">2</span></td>
                                        <td>API接口未启用</td>
                                        <td>403</td>
                                        <td>联系管理员启用API接口</td>
                                    </tr>
                                    <tr class="table-danger">
                                        <td><span class="badge bg-danger">3</span></td>
                                        <td>系统错误</td>
                                        <td>500</td>
                                        <td>服务器内部错误，稍后重试</td>
                                    </tr>
                                    <tr class="table-warning">
                                        <td><span class="badge bg-warning">4</span></td>
                                        <td>API密钥无效</td>
                                        <td>401</td>
                                        <td>检查API密钥是否正确或已被禁用</td>
                                    </tr>
                                    <tr class="table-danger">
                                        <td><span class="badge bg-danger">5</span></td>
                                        <td>卡密已被禁用</td>
                                        <td>403</td>
                                        <td>联系管理员处理禁用的卡密</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- API端点详细说明 -->
                <div class="row mb-5">
                    <div class="col-12">
                        <h4 class="text-info mb-3">
                            <i class="fas fa-plug me-2"></i>API端点详细说明
                        </h4>

                        <!-- 卡密验证接口 -->
                        <div class="api-endpoint-card mb-4">
                            <div class="card border-primary">
                                <div class="card-header bg-primary text-white">
                                    <h5 class="mb-0">
                                        <span class="badge bg-light text-primary me-2">POST</span>
                                        /api/v1/verify/ - 卡密验证
                                    </h5>
                                </div>
                                <div class="card-body">
                                    <p class="text-muted">验证卡密的有效性，支持设备绑定功能</p>

                                    <div class="row">
                                        <div class="col-md-6">
                                            <h6 class="text-primary">请求参数</h6>
                                            <div class="table-responsive">
                                                <table class="table table-sm">
                                                    <thead>
                                                        <tr>
                                                            <th>参数名</th>
                                                            <th>类型</th>
                                                            <th>必填</th>
                                                            <th>说明</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr>
                                                            <td><code>api_key</code></td>
                                                            <td>string</td>
                                                            <td><span class="badge bg-danger">是</span></td>
                                                            <td>API密钥</td>
                                                        </tr>
                                                        <tr>
                                                            <td><code>card_key</code></td>
                                                            <td>string</td>
                                                            <td><span class="badge bg-danger">是</span></td>
                                                            <td>卡密</td>
                                                        </tr>
                                                        <tr>
                                                            <td><code>device_id</code></td>
                                                            <td>string</td>
                                                            <td><span class="badge bg-secondary">否</span></td>
                                                            <td>设备ID（用于设备绑定）</td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <h6 class="text-primary">响应示例</h6>
                                            <div class="code-block">
                                                <pre><code>{
  "code": 0,
  "success": true,
  "message": "验证成功",
  "data": {
    "card_type": "time",
    "expire_date": "2024-12-31T23:59:59Z",
    "remaining_count": null,
    "device_binding": {
      "device_id": "DEVICE-001",
      "is_new_device": false
    }
  }
}</code></pre>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- 卡密查询接口 -->
                        <div class="api-endpoint-card mb-4">
                            <div class="card border-success">
                                <div class="card-header bg-success text-white">
                                    <h5 class="mb-0">
                                        <span class="badge bg-light text-success me-2">POST</span>
                                        /api/v1/query/ - 卡密查询
                                    </h5>
                                </div>
                                <div class="card-body">
                                    <p class="text-muted">查询卡密的详细信息，包括使用记录和设备绑定</p>

                                    <div class="row">
                                        <div class="col-md-6">
                                            <h6 class="text-success">请求参数</h6>
                                            <div class="table-responsive">
                                                <table class="table table-sm">
                                                    <thead>
                                                        <tr>
                                                            <th>参数名</th>
                                                            <th>类型</th>
                                                            <th>必填</th>
                                                            <th>说明</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr>
                                                            <td><code>api_key</code></td>
                                                            <td>string</td>
                                                            <td><span class="badge bg-danger">是</span></td>
                                                            <td>API密钥</td>
                                                        </tr>
                                                        <tr>
                                                            <td><code>card_key</code></td>
                                                            <td>string</td>
                                                            <td><span class="badge bg-danger">是</span></td>
                                                            <td>卡密</td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <h6 class="text-success">响应示例</h6>
                                            <div class="code-block">
                                                <pre><code>{
  "code": 0,
  "success": true,
  "message": "查询成功",
  "data": {
    "card_info": {
      "card_type": "count",
      "status": "active",
      "total_count": 100,
      "used_count": 25,
      "remaining_count": 75
    },
    "device_bindings": [...],
    "recent_logs": [...]
  }
}</code></pre>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="mt-4 text-center">
                    {% if user.is_authenticated %}
                        <a href="{% url 'api:key_list' %}" class="btn btn-primary btn-lg me-3">
                            <i class="fas fa-key me-2"></i>管理API密钥
                        </a>
                        <a href="#code-examples" class="btn btn-outline-primary btn-lg">
                            <i class="fas fa-code me-2"></i>查看代码示例
                        </a>
                    {% else %}
                        <div class="alert alert-info">
                            <i class="fas fa-info-circle me-2"></i>
                            请先登录以获取API密钥并开始使用验证服务
                        </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</div>

<!-- 多语言代码示例 -->
<div class="row animate-on-scroll mt-5" id="code-examples">
    <div class="col-12">
        <div class="card card-glass">
            <div class="card-header">
                <h3 class="mb-0">
                    <i class="fas fa-code me-2"></i>多语言调用示例
                </h3>
            </div>
            <div class="card-body">
                <!-- 语言选择标签 -->
                <ul class="nav nav-pills mb-4" id="codeExampleTabs" role="tablist">
                    <li class="nav-item" role="presentation">
                        <button class="nav-link active" id="python-tab" data-bs-toggle="pill" data-bs-target="#python" type="button" role="tab">
                            <i class="fab fa-python me-2"></i>Python
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="javascript-tab" data-bs-toggle="pill" data-bs-target="#javascript" type="button" role="tab">
                            <i class="fab fa-js-square me-2"></i>JavaScript
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="php-tab" data-bs-toggle="pill" data-bs-target="#php" type="button" role="tab">
                            <i class="fab fa-php me-2"></i>PHP
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="java-tab" data-bs-toggle="pill" data-bs-target="#java" type="button" role="tab">
                            <i class="fab fa-java me-2"></i>Java
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="curl-tab" data-bs-toggle="pill" data-bs-target="#curl" type="button" role="tab">
                            <i class="fas fa-terminal me-2"></i>cURL
                        </button>
                    </li>
                </ul>

                <!-- 代码示例内容 -->
                <div class="tab-content" id="codeExampleContent">
                    <!-- Python 示例 -->
                    <div class="tab-pane fade show active" id="python" role="tabpanel">
                        <div class="code-example">
                            <div class="d-flex justify-content-between align-items-center mb-2">
                                <h6 class="text-primary mb-0">Python (使用 requests 库)</h6>
                                <button class="btn btn-sm btn-outline-secondary copy-btn" data-target="python-code">
                                    <i class="fas fa-copy me-1"></i>复制
                                </button>
                            </div>
                            <div class="code-block" id="python-code">
                                <pre><code>import requests
import json

# API配置
api_url = "{{ request.scheme }}://{{ request.get_host }}/api/v1/verify/"
api_key = "your_api_key_here"

# 请求数据
data = {
    "api_key": api_key,
    "card_key": "your_card_key_here",
    "device_id": "optional_device_id"
}

try:
    # 发送请求
    response = requests.post(api_url, json=data, timeout=30)
    result = response.json()

    # 处理响应
    if result['success']:
        print("验证成功!")
        print(f"卡密类型: {result['data']['card_type']}")
        if result['data']['expire_date']:
            print(f"过期时间: {result['data']['expire_date']}")
        if result['data']['remaining_count']:
            print(f"剩余次数: {result['data']['remaining_count']}")
    else:
        print(f"验证失败: {result['message']}")
        print(f"错误码: {result['code']}")

except requests.exceptions.RequestException as e:
    print(f"请求失败: {e}")
except json.JSONDecodeError:
    print("响应格式错误")
except KeyError as e:
    print(f"响应缺少字段: {e}")</code></pre>
                            </div>
                        </div>
                    </div>

                    <!-- JavaScript 示例 -->
                    <div class="tab-pane fade" id="javascript" role="tabpanel">
                        <div class="code-example">
                            <div class="d-flex justify-content-between align-items-center mb-2">
                                <h6 class="text-success mb-0">JavaScript (使用 fetch API)</h6>
                                <button class="btn btn-sm btn-outline-secondary copy-btn" data-target="javascript-code">
                                    <i class="fas fa-copy me-1"></i>复制
                                </button>
                            </div>
                            <div class="code-block" id="javascript-code">
                                <pre><code>// API配置
const apiUrl = "{{ request.scheme }}://{{ request.get_host }}/api/v1/verify/";
const apiKey = "your_api_key_here";

// 请求数据
const data = {
    api_key: apiKey,
    card_key: "your_card_key_here",
    device_id: "optional_device_id"
};

// 发送请求
async function verifyCard() {
    try {
        const response = await fetch(apiUrl, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify(data)
        });

        const result = await response.json();

        // 处理响应
        if (result.success) {
            console.log("验证成功!");
            console.log(`卡密类型: ${result.data.card_type}`);
            if (result.data.expire_date) {
                console.log(`过期时间: ${result.data.expire_date}`);
            }
            if (result.data.remaining_count) {
                console.log(`剩余次数: ${result.data.remaining_count}`);
            }
        } else {
            console.log(`验证失败: ${result.message}`);
            console.log(`错误码: ${result.code}`);
        }
    } catch (error) {
        console.error("请求失败:", error);
    }
}

// 调用函数
verifyCard();</code></pre>
                            </div>
                        </div>
                    </div>

                    <!-- PHP 示例 -->
                    <div class="tab-pane fade" id="php" role="tabpanel">
                        <div class="code-example">
                            <div class="d-flex justify-content-between align-items-center mb-2">
                                <h6 class="text-warning mb-0">PHP (使用 cURL)</h6>
                                <button class="btn btn-sm btn-outline-secondary copy-btn" data-target="php-code">
                                    <i class="fas fa-copy me-1"></i>复制
                                </button>
                            </div>
                            <div class="code-block" id="php-code">
                                <pre><code>&lt;?php
// API配置
$apiUrl = "{{ request.scheme }}://{{ request.get_host }}/api/v1/verify/";
$apiKey = "your_api_key_here";

// 请求数据
$data = array(
    'api_key' => $apiKey,
    'card_key' => 'your_card_key_here',
    'device_id' => 'optional_device_id'
);

// 初始化cURL
$ch = curl_init();

// 设置cURL选项
curl_setopt($ch, CURLOPT_URL, $apiUrl);
curl_setopt($ch, CURLOPT_POST, true);
curl_setopt($ch, CURLOPT_POSTFIELDS, json_encode($data));
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
curl_setopt($ch, CURLOPT_TIMEOUT, 30);
curl_setopt($ch, CURLOPT_HTTPHEADER, array(
    'Content-Type: application/json',
    'Content-Length: ' . strlen(json_encode($data))
));

// 执行请求
$response = curl_exec($ch);
$httpCode = curl_getinfo($ch, CURLINFO_HTTP_CODE);

// 检查错误
if (curl_error($ch)) {
    echo "请求失败: " . curl_error($ch);
    curl_close($ch);
    exit;
}

curl_close($ch);

// 解析响应
$result = json_decode($response, true);

if ($result === null) {
    echo "响应格式错误";
    exit;
}

// 处理响应
if ($result['success']) {
    echo "验证成功!\n";
    echo "卡密类型: " . $result['data']['card_type'] . "\n";
    if (!empty($result['data']['expire_date'])) {
        echo "过期时间: " . $result['data']['expire_date'] . "\n";
    }
    if (!empty($result['data']['remaining_count'])) {
        echo "剩余次数: " . $result['data']['remaining_count'] . "\n";
    }
} else {
    echo "验证失败: " . $result['message'] . "\n";
    echo "错误码: " . $result['code'] . "\n";
}
?&gt;</code></pre>
                            </div>
                        </div>
                    </div>

                    <!-- Java 示例 -->
                    <div class="tab-pane fade" id="java" role="tabpanel">
                        <div class="code-example">
                            <div class="d-flex justify-content-between align-items-center mb-2">
                                <h6 class="text-danger mb-0">Java (使用 HttpURLConnection)</h6>
                                <button class="btn btn-sm btn-outline-secondary copy-btn" data-target="java-code">
                                    <i class="fas fa-copy me-1"></i>复制
                                </button>
                            </div>
                            <div class="code-block" id="java-code">
                                <pre><code>import java.io.*;
import java.net.*;
import org.json.*;

public class CardVerification {
    private static final String API_URL = "{{ request.scheme }}://{{ request.get_host }}/api/v1/verify/";
    private static final String API_KEY = "your_api_key_here";

    public static void main(String[] args) {
        try {
            // 创建请求数据
            JSONObject data = new JSONObject();
            data.put("api_key", API_KEY);
            data.put("card_key", "your_card_key_here");
            data.put("device_id", "optional_device_id");

            // 创建连接
            URL url = new URL(API_URL);
            HttpURLConnection conn = (HttpURLConnection) url.openConnection();

            // 设置请求属性
            conn.setRequestMethod("POST");
            conn.setRequestProperty("Content-Type", "application/json");
            conn.setDoOutput(true);
            conn.setConnectTimeout(30000);
            conn.setReadTimeout(30000);

            // 发送请求数据
            try (OutputStream os = conn.getOutputStream()) {
                byte[] input = data.toString().getBytes("utf-8");
                os.write(input, 0, input.length);
            }

            // 读取响应
            StringBuilder response = new StringBuilder();
            try (BufferedReader br = new BufferedReader(
                    new InputStreamReader(conn.getInputStream(), "utf-8"))) {
                String responseLine;
                while ((responseLine = br.readLine()) != null) {
                    response.append(responseLine.trim());
                }
            }

            // 解析响应
            JSONObject result = new JSONObject(response.toString());

            // 处理响应
            if (result.getBoolean("success")) {
                System.out.println("验证成功!");
                JSONObject cardData = result.getJSONObject("data");
                System.out.println("卡密类型: " + cardData.getString("card_type"));

                if (cardData.has("expire_date") && !cardData.isNull("expire_date")) {
                    System.out.println("过期时间: " + cardData.getString("expire_date"));
                }
                if (cardData.has("remaining_count") && !cardData.isNull("remaining_count")) {
                    System.out.println("剩余次数: " + cardData.getInt("remaining_count"));
                }
            } else {
                System.out.println("验证失败: " + result.getString("message"));
                System.out.println("错误码: " + result.getInt("code"));
            }

        } catch (Exception e) {
            System.err.println("请求失败: " + e.getMessage());
            e.printStackTrace();
        }
    }
}</code></pre>
                            </div>
                        </div>
                    </div>

                    <!-- cURL 示例 -->
                    <div class="tab-pane fade" id="curl" role="tabpanel">
                        <div class="code-example">
                            <div class="d-flex justify-content-between align-items-center mb-2">
                                <h6 class="text-info mb-0">cURL 命令行</h6>
                                <button class="btn btn-sm btn-outline-secondary copy-btn" data-target="curl-code">
                                    <i class="fas fa-copy me-1"></i>复制
                                </button>
                            </div>
                            <div class="code-block" id="curl-code">
                                <pre><code># 卡密验证请求
curl -X POST {{ request.scheme }}://{{ request.get_host }}/api/v1/verify/ \
  -H "Content-Type: application/json" \
  -d '{
    "api_key": "your_api_key_here",
    "card_key": "your_card_key_here",
    "device_id": "optional_device_id"
  }'

# 卡密查询请求
curl -X POST {{ request.scheme }}://{{ request.get_host }}/api/v1/query/ \
  -H "Content-Type: application/json" \
  -d '{
    "api_key": "your_api_key_here",
    "card_key": "your_card_key_here"
  }'

# 带超时和详细输出的请求
curl -X POST {{ request.scheme }}://{{ request.get_host }}/api/v1/verify/ \
  -H "Content-Type: application/json" \
  -d '{
    "api_key": "your_api_key_here",
    "card_key": "your_card_key_here",
    "device_id": "optional_device_id"
  }' \
  --connect-timeout 30 \
  --max-time 60 \
  -v</code></pre>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 最佳实践 -->
                <div class="row mt-5">
                    <div class="col-12">
                        <h4 class="text-success mb-3">
                            <i class="fas fa-lightbulb me-2"></i>最佳实践
                        </h4>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="card border-success mb-3">
                                    <div class="card-header bg-success text-white">
                                        <h6 class="mb-0">错误处理</h6>
                                    </div>
                                    <div class="card-body">
                                        <ul class="list-unstyled mb-0">
                                            <li><i class="fas fa-check text-success me-2"></i>始终检查 <code>success</code> 字段</li>
                                            <li><i class="fas fa-check text-success me-2"></i>根据 <code>code</code> 字段处理不同错误</li>
                                            <li><i class="fas fa-check text-success me-2"></i>设置合适的请求超时时间</li>
                                            <li><i class="fas fa-check text-success me-2"></i>记录错误日志便于调试</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="card border-warning mb-3">
                                    <div class="card-header bg-warning text-dark">
                                        <h6 class="mb-0">安全注意事项</h6>
                                    </div>
                                    <div class="card-body">
                                        <ul class="list-unstyled mb-0">
                                            <li><i class="fas fa-shield-alt text-warning me-2"></i>妥善保管API密钥</li>
                                            <li><i class="fas fa-shield-alt text-warning me-2"></i>使用HTTPS传输数据</li>
                                            <li><i class="fas fa-shield-alt text-warning me-2"></i>不在客户端暴露API密钥</li>
                                            <li><i class="fas fa-shield-alt text-warning me-2"></i>定期更换API密钥</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
/* 英雄区域增强动画 */
.hero-badge-animate {
    animation: badge-float 3s ease-in-out infinite;
}

@keyframes badge-float {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-5px); }
}

.hero-title-animate {
    animation: title-slide-in 1s cubic-bezier(0.4, 0, 0.2, 1) 0.2s both;
}

.hero-subtitle-animate {
    animation: title-slide-in 1s cubic-bezier(0.4, 0, 0.2, 1) 0.4s both;
}

.hero-description-animate {
    animation: fade-slide-up 1s cubic-bezier(0.4, 0, 0.2, 1) 0.6s both;
}

@keyframes title-slide-in {
    0% {
        opacity: 0;
        transform: translateX(-30px);
    }
    100% {
        opacity: 1;
        transform: translateX(0);
    }
}

@keyframes fade-slide-up {
    0% {
        opacity: 0;
        transform: translateY(20px);
    }
    100% {
        opacity: 1;
        transform: translateY(0);
    }
}

/* 特性亮点样式 */
.hero-features {
    display: flex;
    flex-wrap: wrap;
    gap: 1rem;
    margin: 2rem 0;
}

.feature-item {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.75rem 1rem;
    background: var(--glass-bg);
    border: 1px solid var(--glass-border);
    border-radius: 25px;
    color: var(--text-secondary);
    font-size: 14px;
    font-weight: 500;
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    animation: feature-slide-in 0.8s cubic-bezier(0.4, 0, 0.2, 1) calc(0.8s + var(--delay, 0s)) both;
}

.feature-item:nth-child(1) { --delay: 0s; }
.feature-item:nth-child(2) { --delay: 0.1s; }
.feature-item:nth-child(3) { --delay: 0.2s; }
.feature-item:nth-child(4) { --delay: 0.3s; }

@keyframes feature-slide-in {
    0% {
        opacity: 0;
        transform: translateY(20px) scale(0.9);
    }
    100% {
        opacity: 1;
        transform: translateY(0) scale(1);
    }
}

.feature-item:hover {
    background: rgba(59, 130, 246, 0.1);
    border-color: var(--primary-color);
    color: var(--primary-color);
    transform: translateY(-2px) scale(1.05);
    box-shadow: 0 8px 25px rgba(59, 130, 246, 0.2);
}

.feature-item i {
    font-size: 16px;
    color: var(--primary-color);
}

/* 按钮动画 */
.hero-btn-animate {
    animation: btn-slide-up 1s cubic-bezier(0.4, 0, 0.2, 1) 1s both;
}

@keyframes btn-slide-up {
    0% {
        opacity: 0;
        transform: translateY(30px);
    }
    100% {
        opacity: 1;
        transform: translateY(0);
    }
}

/* 图片动画增强 */
.hero-image-animate {
    animation: image-float 6s ease-in-out infinite;
    position: relative;
}

.hero-custom-image {
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    filter: drop-shadow(0 20px 40px rgba(0, 0, 0, 0.3));
}

.hero-image-container:hover .hero-custom-image {
    transform: scale(1.05) rotate(1deg);
    filter: drop-shadow(0 25px 50px rgba(0, 0, 0, 0.4));
}

.image-overlay {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(45deg, rgba(59, 130, 246, 0.1), rgba(6, 182, 212, 0.1));
    border-radius: 20px;
    opacity: 0;
    transition: opacity 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

.hero-image-container:hover .image-overlay {
    opacity: 1;
}

/* 图标动画增强 */
.hero-icon-animate {
    animation: icon-entrance 1.5s cubic-bezier(0.4, 0, 0.2, 1) 0.5s both;
}

@keyframes icon-entrance {
    0% {
        opacity: 0;
        transform: scale(0.5) rotate(-180deg);
    }
    100% {
        opacity: 1;
        transform: scale(1) rotate(0deg);
    }
}

.hero-glow {
    position: absolute;
    top: 50%;
    left: 50%;
    width: 200px;
    height: 200px;
    background: radial-gradient(circle, rgba(59, 130, 246, 0.3) 0%, transparent 70%);
    border-radius: 50%;
    transform: translate(-50%, -50%);
    animation: glow-pulse 4s ease-in-out infinite;
    z-index: -1;
}

@keyframes glow-pulse {
    0%, 100% {
        opacity: 0.5;
        transform: translate(-50%, -50%) scale(1);
    }
    50% {
        opacity: 0.8;
        transform: translate(-50%, -50%) scale(1.2);
    }
}

/* 响应式优化 */
@media (max-width: 768px) {
    .hero-features {
        justify-content: center;
    }

    .feature-item {
        font-size: 13px;
        padding: 0.5rem 0.75rem;
    }

    .hero-actions {
        justify-content: center;
        text-align: center;
    }

    .hero-actions .btn {
        width: 100%;
        max-width: 280px;
    }
}

@media (max-width: 576px) {
    .hero-features {
        flex-direction: column;
        align-items: center;
    }

    .feature-item {
        width: 100%;
        max-width: 200px;
        justify-content: center;
    }
}

/* API文档样式 */
.code-block {
    background: #1e1e1e;
    border-radius: 8px;
    padding: 1rem;
    margin: 1rem 0;
    overflow-x: auto;
    position: relative;
}

.code-block pre {
    margin: 0;
    color: #d4d4d4;
    font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
    font-size: 14px;
    line-height: 1.5;
}

.code-block code {
    color: #d4d4d4;
    background: none;
    padding: 0;
    font-size: inherit;
}

.api-endpoint-card {
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

.api-endpoint-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
}

.copy-btn {
    transition: all 0.3s ease;
}

.copy-btn:hover {
    background-color: var(--primary-color);
    color: white;
    border-color: var(--primary-color);
}

.copy-btn.copied {
    background-color: #28a745;
    border-color: #28a745;
    color: white;
}

.nav-pills .nav-link {
    border-radius: 25px;
    margin-right: 0.5rem;
    transition: all 0.3s ease;
}

.nav-pills .nav-link:hover {
    background-color: rgba(var(--primary-rgb), 0.1);
    color: var(--primary-color);
}

.nav-pills .nav-link.active {
    background-color: var(--primary-color);
    color: white;
}

.code-example {
    position: relative;
}

/* 深色模式适配 */
[data-bs-theme="dark"] .code-block {
    background: #0d1117;
    border: 1px solid #30363d;
}

[data-bs-theme="dark"] .code-block pre,
[data-bs-theme="dark"] .code-block code {
    color: #e6edf3;
}

[data-bs-theme="dark"] .table {
    --bs-table-bg: transparent;
    --bs-table-border-color: #30363d;
}

[data-bs-theme="dark"] .nav-pills .nav-link:hover {
    background-color: rgba(255, 255, 255, 0.1);
    color: #e6edf3;
}

/* 响应式设计 */
@media (max-width: 768px) {
    .code-block {
        font-size: 12px;
        padding: 0.75rem;
    }

    .nav-pills {
        flex-wrap: wrap;
    }

    .nav-pills .nav-link {
        margin-bottom: 0.5rem;
        font-size: 14px;
    }

    .table-responsive {
        font-size: 14px;
    }
}

@media (max-width: 576px) {
    .code-block {
        font-size: 11px;
        padding: 0.5rem;
    }

    .nav-pills .nav-link {
        font-size: 13px;
        padding: 0.5rem 0.75rem;
    }
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // 复制代码功能
    const copyButtons = document.querySelectorAll('.copy-btn');

    copyButtons.forEach(button => {
        button.addEventListener('click', function() {
            const targetId = this.getAttribute('data-target');
            const codeBlock = document.getElementById(targetId);
            const code = codeBlock.querySelector('code').textContent;

            // 创建临时文本区域
            const textarea = document.createElement('textarea');
            textarea.value = code;
            document.body.appendChild(textarea);
            textarea.select();

            try {
                document.execCommand('copy');

                // 更新按钮状态
                const originalText = this.innerHTML;
                this.innerHTML = '<i class="fas fa-check me-1"></i>已复制';
                this.classList.add('copied');

                // 2秒后恢复原状
                setTimeout(() => {
                    this.innerHTML = originalText;
                    this.classList.remove('copied');
                }, 2000);

            } catch (err) {
                console.error('复制失败:', err);
                alert('复制失败，请手动复制代码');
            }

            document.body.removeChild(textarea);
        });
    });

    // 平滑滚动到锚点
    const anchorLinks = document.querySelectorAll('a[href^="#"]');

    anchorLinks.forEach(link => {
        link.addEventListener('click', function(e) {
            const targetId = this.getAttribute('href');
            const targetElement = document.querySelector(targetId);

            if (targetElement) {
                e.preventDefault();
                targetElement.scrollIntoView({
                    behavior: 'smooth',
                    block: 'start'
                });
            }
        });
    });

    // 代码高亮（简单版本）
    const codeBlocks = document.querySelectorAll('.code-block code');

    codeBlocks.forEach(block => {
        let html = block.innerHTML;

        // 简单的语法高亮
        html = html.replace(/(".*?")/g, '<span style="color: #ce9178;">$1</span>'); // 字符串
        html = html.replace(/\b(true|false|null|undefined)\b/g, '<span style="color: #569cd6;">$1</span>'); // 布尔值
        html = html.replace(/\b(\d+)\b/g, '<span style="color: #b5cea8;">$1</span>'); // 数字
        html = html.replace(/\b(if|else|for|while|function|return|var|let|const|import|export|class|def|try|except|catch|finally)\b/g, '<span style="color: #c586c0;">$1</span>'); // 关键字

        block.innerHTML = html;
    });
});
</script>
{% endblock %}
